%{
  titleKey = 'ScheduledOrders.edit.title';
}%
#{extends 'main.html'/}
#{set navSelected: ['nav.tenantsettings', 'nav.tenants'] /}
#{set 'title'}&{titleKey}#{/set}


<div class="container" ng-controller="schedulerEditCtrl">
#{Form.header titleKey:titleKey /}

#{alerts/}

#{form @save(), id:'scheduleEventForm', class:'form form-horizontal', autocomplete:"off"}
    <input type="hidden" name="id" value="{{scheduler.id}}">
    
    #{Services.scheduler /}
    
    #{Form.saveCancel cancelHref:referrer/}

#{/form}

</div>

#{set 'moreScripts'}
<script type="text/javascript">
    $(document).ready(function() {

        // know where it came from so can navigate back;
        // only set the referrerUrl if it has not been set at some earlier point 
        // i.e. in multi-step flows take into account error-handling
        var referrerUrl = $('input[name="project.referrerUrl"]').val();
        if(!referrerUrl)
            referrerUrl = document.referrer;

        // navigate back only if referral URL is different than this one
        if(referrerUrl && referrerUrl != document.URL) {
            $('input[name="project.referrerUrl"]').val(referrerUrl);
            // navigate cancel button to referrer url
            $('div.form-actions a.btn').attr('href', referrerUrl);
        }
    });

</script>
#{/set}
